server 端发起一个任务，并push 给客户端，客户端接受后，执行。

ansible => saltstack

- 易于使用：ansible
- 功能：saltstack
- 因为有agent， 所以可以做的事情有很多

### 功能
- 分发任务并执行任务
    - 所谓的任务就是脚本
- 执行结果
- 日志
- 要能够被控制
    - 控制并行
        - 能够同时执行多少台机器
    - 对错误进行响应
        - 最多允许失败多少，超出范围则终止
            - 客户端需要告诉服务端 执行结果
            - timeout
    - 有权利对任务终止
- 跨机房部署
- job 版本管理


### 目标
- 存活下来，直接可以用起来
- 基于现有功能做一个web
- 多机房、多活，优化
- 回馈社区，开源

### 设计
- 有agent
    - 安装、部署
    - 升级，在线升级
- 无agent
    - 容易造成安全隐患
    - root、秘钥
    - 并行效率
    - 安装、部署

### agent执行任务

### 描写任务
- script
- 目标节点
- 并行方式运行
- 允许错误发生，但需要强调错误率（我们需要对错误进行反馈）（要能够拿到客户端的结果）
- 超时时间
- 参数
    - 环境变量
    - 命令行参数
        - rm -rf /etc/$TEMP
    - 解析脚本
        - $1 $# $?
        
        
- 用户到master的通讯协议：http，应用层协议
- master到agent 用 tcp，底层协议：websocket，http2











